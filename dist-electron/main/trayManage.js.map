{"version":3,"sources":["../../electron/main/trayManage.ts"],"sourcesContent":["import { app, Menu, Tray } from \"electron\";\nimport { hideWindow, showWindow } from \"./windowManage\";\nimport { join } from \"node:path\";\nimport { isMac } from \"../utils\";\n\nlet appTray: Tray;\nlet timer: NodeJS.Timeout | null = null;\n\nexport const createTray = () => {\n  const trayMenu = Menu.buildFromTemplate([\n    {\n      label: \"显示主界面\",\n      click: showWindow,\n    },\n    {\n      label: \"隐藏主界面\",\n      click: hideWindow,\n    },\n    {\n      label: \"退出\",\n      click: () => {\n        global.forceQuit = true;\n        app.quit();\n      },\n    },\n  ]);\n  appTray = new Tray(global.pathConfig.trayIcon);\n  appTray.setToolTip(app.getName());\n  appTray.setIgnoreDoubleClickEvents(true);\n  appTray.on(\"right-click\", () => {\n    appTray.popUpContextMenu(trayMenu);\n  });\n  appTray.on(\"click\", showWindow);\n\n  // appTray.setContextMenu(trayMenu);\n};\n\nexport const traySetTitle = (str) => {\n  appTray.setTitle(str);\n};\n\nexport const destroyTray = () => {\n  if (!appTray || appTray.isDestroyed()) return;\n  clearTimeout(timer);\n  appTray.destroy();\n  appTray = null;\n};\n\nconst blinkTime = 1000;\nexport const traySetImage = (isBlink: boolean) => {\n  if (isMac || !appTray) return;\n  clearTimeout(timer);\n  if (isBlink) {\n    appTray.setImage(join(global.pathConfig.publicPath, \"/icons/tray_clear.png\"));\n    timer = setTimeout(() => {\n      appTray.setImage(global.pathConfig.trayIconTip);\n      timer = setTimeout(() => {\n        traySetImage(true);\n      }, blinkTime);\n    }, blinkTime);\n    return;\n  }\n  appTray.setImage(global.pathConfig.trayIcon);\n};\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAgC;AAChC,0BAAuC;AACvC,uBAAqB;AACrB,mBAAsB;AAEtB,IAAI;AACJ,IAAI,QAA+B;AAE5B,MAAM,aAAa,MAAM;AAC9B,QAAM,WAAW,qBAAK,kBAAkB;AAAA,IACtC;AAAA,MACE,OAAO;AAAA,MACP,OAAO;AAAA,IACT;AAAA,IACA;AAAA,MACE,OAAO;AAAA,MACP,OAAO;AAAA,IACT;AAAA,IACA;AAAA,MACE,OAAO;AAAA,MACP,OAAO,MAAM;AACX,eAAO,YAAY;AACnB,4BAAI,KAAK;AAAA,MACX;AAAA,IACF;AAAA,EACF,CAAC;AACD,YAAU,IAAI,qBAAK,OAAO,WAAW,QAAQ;AAC7C,UAAQ,WAAW,oBAAI,QAAQ,CAAC;AAChC,UAAQ,2BAA2B,IAAI;AACvC,UAAQ,GAAG,eAAe,MAAM;AAC9B,YAAQ,iBAAiB,QAAQ;AAAA,EACnC,CAAC;AACD,UAAQ,GAAG,SAAS,8BAAU;AAGhC;AAEO,MAAM,eAAe,CAAC,QAAQ;AACnC,UAAQ,SAAS,GAAG;AACtB;AAEO,MAAM,cAAc,MAAM;AAC/B,MAAI,CAAC,WAAW,QAAQ,YAAY;AAAG;AACvC,eAAa,KAAK;AAClB,UAAQ,QAAQ;AAChB,YAAU;AACZ;AAEA,MAAM,YAAY;AACX,MAAM,eAAe,CAAC,YAAqB;AAChD,MAAI,sBAAS,CAAC;AAAS;AACvB,eAAa,KAAK;AAClB,MAAI,SAAS;AACX,YAAQ,aAAS,uBAAK,OAAO,WAAW,YAAY,uBAAuB,CAAC;AAC5E,YAAQ,WAAW,MAAM;AACvB,cAAQ,SAAS,OAAO,WAAW,WAAW;AAC9C,cAAQ,WAAW,MAAM;AACvB,qBAAa,IAAI;AAAA,MACnB,GAAG,SAAS;AAAA,IACd,GAAG,SAAS;AACZ;AAAA,EACF;AACA,UAAQ,SAAS,OAAO,WAAW,QAAQ;AAC7C;","names":[],"file":"trayManage.js"}