{"version":3,"sources":["../../../electron/utils/window-badge/index.js"],"sourcesContent":["import { nativeImage, ipcMain } from \"electron\";\nimport BadgeGenerator from \"./badge_generator.js\";\nconst badgeDescription = \"New notification\";\nconst UPDATE_BADGE_EVENT = \"update-badge\";\nlet currentOverlayIcon = { image: null, badgeDescription };\n\nmodule.exports = class Badge {\n  constructor(win, opts = {}) {\n    this.win = win;\n    this.opts = opts;\n    this.generator = new BadgeGenerator(win, opts);\n    this.initListeners();\n    this.win.on(\"closed\", () => {\n      this.win = null;\n    });\n    this.win.on(\"show\", () => {\n      this.win.setOverlayIcon(\n        currentOverlayIcon.image,\n        currentOverlayIcon.badgeDescription,\n      );\n    });\n  }\n\n  update(badgeNumber) {\n    if (badgeNumber) {\n      this.generator.generate(badgeNumber).then((base64) => {\n        const image = nativeImage.createFromDataURL(base64);\n        currentOverlayIcon = {\n          image,\n          badgeDescription,\n        };\n        this.win.setOverlayIcon(\n          currentOverlayIcon.image,\n          currentOverlayIcon.badgeDescription,\n        );\n      });\n    } else {\n      currentOverlayIcon = {\n        image: null,\n        badgeDescription,\n      };\n      this.win.setOverlayIcon(\n        currentOverlayIcon.image,\n        currentOverlayIcon.badgeDescription,\n      );\n    }\n  }\n\n  initListeners() {\n    ipcMain.on(UPDATE_BADGE_EVENT, (event, badgeNumber) => {\n      if (this.win) {\n        this.update(badgeNumber);\n      }\n      event.returnValue = \"success\";\n    });\n  }\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,sBAAqC;AACrC,6BAA2B;AAC3B,MAAM,mBAAmB;AACzB,MAAM,qBAAqB;AAC3B,IAAI,qBAAqB,EAAE,OAAO,MAAM,iBAAiB;AAEzD,OAAO,UAAU,MAAM,MAAM;AAAA,EAC3B,YAAY,KAAK,OAAO,CAAC,GAAG;AAC1B,SAAK,MAAM;AACX,SAAK,OAAO;AACZ,SAAK,YAAY,IAAI,uBAAAA,QAAe,KAAK,IAAI;AAC7C,SAAK,cAAc;AACnB,SAAK,IAAI,GAAG,UAAU,MAAM;AAC1B,WAAK,MAAM;AAAA,IACb,CAAC;AACD,SAAK,IAAI,GAAG,QAAQ,MAAM;AACxB,WAAK,IAAI;AAAA,QACP,mBAAmB;AAAA,QACnB,mBAAmB;AAAA,MACrB;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,OAAO,aAAa;AAClB,QAAI,aAAa;AACf,WAAK,UAAU,SAAS,WAAW,EAAE,KAAK,CAAC,WAAW;AACpD,cAAM,QAAQ,4BAAY,kBAAkB,MAAM;AAClD,6BAAqB;AAAA,UACnB;AAAA,UACA;AAAA,QACF;AACA,aAAK,IAAI;AAAA,UACP,mBAAmB;AAAA,UACnB,mBAAmB;AAAA,QACrB;AAAA,MACF,CAAC;AAAA,IACH,OAAO;AACL,2BAAqB;AAAA,QACnB,OAAO;AAAA,QACP;AAAA,MACF;AACA,WAAK,IAAI;AAAA,QACP,mBAAmB;AAAA,QACnB,mBAAmB;AAAA,MACrB;AAAA,IACF;AAAA,EACF;AAAA,EAEA,gBAAgB;AACd,4BAAQ,GAAG,oBAAoB,CAAC,OAAO,gBAAgB;AACrD,UAAI,KAAK,KAAK;AACZ,aAAK,OAAO,WAAW;AAAA,MACzB;AACA,YAAM,cAAc;AAAA,IACtB,CAAC;AAAA,EACH;AACF;","names":["BadgeGenerator"],"file":"index.js"}