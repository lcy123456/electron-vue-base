{"version":3,"sources":["../../../electron/utils/window-badge/badge_generator.js"],"sourcesContent":["export default class BadgeGenerator {\n  constructor(win, opts = {}) {\n    const defaultStyle = {\n      fontColor: \"white\",\n      font: \"24px arial\",\n      color: \"red\",\n      fit: true,\n      decimals: 0,\n      radius: 8,\n      overflowCount: 99,\n    };\n    this.win = win;\n    this.style = Object.assign(defaultStyle, opts);\n  }\n\n  generate(number) {\n    const opts = JSON.stringify(this.style);\n    return this.win.webContents.executeJavaScript(\n      `window.drawBadge = function ${this.drawBadge}; window.drawBadge(${number}, ${opts});`,\n    );\n  }\n\n  drawBadge(number, style) {\n    var radius = style.radius;\n    var img = document.createElement(\"canvas\");\n    img.width = Math.ceil(radius * 2);\n    img.height = Math.ceil(radius * 2);\n    img.ctx = img.getContext(\"2d\");\n    img.radius = radius;\n    img.number = number;\n    img.displayStyle = style;\n\n    style.color = style.color ? style.color : \"red\";\n    style.font = style.font ? style.font : \"18px arial\";\n    style.fontColor = style.fontColor ? style.fontColor : \"white\";\n    style.fit = style.fit === undefined ? true : style.fit;\n    style.decimals =\n      style.decimals === undefined || isNaN(style.decimals) ? 0 : style.decimals;\n\n    img.draw = function () {\n      var fontSize, number;\n      this.width = Math.ceil(this.radius * 2);\n      this.height = Math.ceil(this.radius * 2);\n      this.ctx.clearRect(0, 0, this.width, this.height);\n      this.ctx.fillStyle = this.displayStyle.color;\n      this.ctx.beginPath();\n      this.ctx.arc(radius, radius, radius, 0, Math.PI * 2);\n      this.ctx.fill();\n      this.ctx.textAlign = \"center\";\n      this.ctx.textBaseline = \"middle\";\n      this.ctx.fillStyle = this.displayStyle.fontColor;\n      number = this.number.toFixed(this.displayStyle.decimals);\n      fontSize = Number(/[0-9\\.]+/.exec(this.ctx.font)[0]);\n      if (number > this.displayStyle.overflowCount) {\n        number = `${this.displayStyle.overflowCount}+`;\n        this.ctx.font = \"8px arial\";\n      } else {\n        this.ctx.font = this.displayStyle.font;\n      }\n\n      if (!this.displayStyle.fit || isNaN(fontSize)) {\n        this.ctx.fillText(number, radius, radius);\n      } else {\n        this.ctx.fillText(number, this.width / 2, this.height / 2);\n      }\n      return this;\n    };\n\n    img.draw();\n    return img.toDataURL();\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAO,eAA6B;AAAA,EAClC,YAAY,KAAK,OAAO,CAAC,GAAG;AAC1B,UAAM,eAAe;AAAA,MACnB,WAAW;AAAA,MACX,MAAM;AAAA,MACN,OAAO;AAAA,MACP,KAAK;AAAA,MACL,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,eAAe;AAAA,IACjB;AACA,SAAK,MAAM;AACX,SAAK,QAAQ,OAAO,OAAO,cAAc,IAAI;AAAA,EAC/C;AAAA,EAEA,SAAS,QAAQ;AACf,UAAM,OAAO,KAAK,UAAU,KAAK,KAAK;AACtC,WAAO,KAAK,IAAI,YAAY;AAAA,MAC1B,+BAA+B,KAAK,SAAS,sBAAsB,MAAM,KAAK,IAAI;AAAA,IACpF;AAAA,EACF;AAAA,EAEA,UAAU,QAAQ,OAAO;AACvB,QAAI,SAAS,MAAM;AACnB,QAAI,MAAM,SAAS,cAAc,QAAQ;AACzC,QAAI,QAAQ,KAAK,KAAK,SAAS,CAAC;AAChC,QAAI,SAAS,KAAK,KAAK,SAAS,CAAC;AACjC,QAAI,MAAM,IAAI,WAAW,IAAI;AAC7B,QAAI,SAAS;AACb,QAAI,SAAS;AACb,QAAI,eAAe;AAEnB,UAAM,QAAQ,MAAM,QAAQ,MAAM,QAAQ;AAC1C,UAAM,OAAO,MAAM,OAAO,MAAM,OAAO;AACvC,UAAM,YAAY,MAAM,YAAY,MAAM,YAAY;AACtD,UAAM,MAAM,MAAM,QAAQ,SAAY,OAAO,MAAM;AACnD,UAAM,WACJ,MAAM,aAAa,UAAa,MAAM,MAAM,QAAQ,IAAI,IAAI,MAAM;AAEpE,QAAI,OAAO,WAAY;AACrB,UAAI,UAAUA;AACd,WAAK,QAAQ,KAAK,KAAK,KAAK,SAAS,CAAC;AACtC,WAAK,SAAS,KAAK,KAAK,KAAK,SAAS,CAAC;AACvC,WAAK,IAAI,UAAU,GAAG,GAAG,KAAK,OAAO,KAAK,MAAM;AAChD,WAAK,IAAI,YAAY,KAAK,aAAa;AACvC,WAAK,IAAI,UAAU;AACnB,WAAK,IAAI,IAAI,QAAQ,QAAQ,QAAQ,GAAG,KAAK,KAAK,CAAC;AACnD,WAAK,IAAI,KAAK;AACd,WAAK,IAAI,YAAY;AACrB,WAAK,IAAI,eAAe;AACxB,WAAK,IAAI,YAAY,KAAK,aAAa;AACvC,MAAAA,UAAS,KAAK,OAAO,QAAQ,KAAK,aAAa,QAAQ;AACvD,iBAAW,OAAO,WAAW,KAAK,KAAK,IAAI,IAAI,EAAE,CAAC,CAAC;AACnD,UAAIA,UAAS,KAAK,aAAa,eAAe;AAC5C,QAAAA,UAAS,GAAG,KAAK,aAAa,aAAa;AAC3C,aAAK,IAAI,OAAO;AAAA,MAClB,OAAO;AACL,aAAK,IAAI,OAAO,KAAK,aAAa;AAAA,MACpC;AAEA,UAAI,CAAC,KAAK,aAAa,OAAO,MAAM,QAAQ,GAAG;AAC7C,aAAK,IAAI,SAASA,SAAQ,QAAQ,MAAM;AAAA,MAC1C,OAAO;AACL,aAAK,IAAI,SAASA,SAAQ,KAAK,QAAQ,GAAG,KAAK,SAAS,CAAC;AAAA,MAC3D;AACA,aAAO;AAAA,IACT;AAEA,QAAI,KAAK;AACT,WAAO,IAAI,UAAU;AAAA,EACvB;AACF;","names":["number"],"file":"badge_generator.js"}